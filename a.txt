changes from elan code

it working fine

somem change here


some more changes add more comments







add more linenew file
